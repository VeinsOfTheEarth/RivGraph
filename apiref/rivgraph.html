

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>rivgraph &mdash; RivGraph 0.4 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="deltas" href="deltas.html" />
    <link rel="prev" title="API Reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/rg_logo_full.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maskmaking/index.html">Maskmaking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shoreline/index.html">Shoreline creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linksnodes/index.html">Link and Node Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">rivgraph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rivgraph-classes-py">RivGraph (classes.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#directionality-utilities-directionality-py">Directionality Utilities (directionality.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#georeferencing-utilities-geo-utils-py">Georeferencing Utilities (geo_utils.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image-utilities-im-utils-py">Image Utilities (im_utils.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-output-utilities-io-utils-py">Input/Output Utilities (io_utils.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-utilities-ln-utils-py">Network Utilities (ln_utils.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mask-to-graph-utilities-mask-to-graph-py">Mask to Graph Utilities (mask_to_graph.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mask-filtering-utils-mask-utils-py">Mask Filtering Utils (mask_utils.py)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skeleton-walking-utils-walk-py">Skeleton Walking Utils (walk.py)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deltas.html">deltas</a></li>
<li class="toctree-l2"><a class="reference internal" href="rivers.html">rivers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RivGraph</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API Reference</a> &raquo;</li>
        
      <li>rivgraph</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/apiref/rivgraph.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rivgraph">
<span id="id1"></span><h1>rivgraph<a class="headerlink" href="#rivgraph" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-rivgraph.classes"></span><div class="section" id="rivgraph-classes-py">
<h2>RivGraph (classes.py)<a class="headerlink" href="#rivgraph-classes-py" title="Permalink to this headline">¶</a></h2>
<p>Classes for running rivgraph commands on your channel network or centerline.</p>
<dl class="class">
<dt id="rivgraph.classes.delta">
<em class="property">class </em><code class="descclassname">rivgraph.classes.</code><code class="descname">delta</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to manage and organize data and methods for analyzing a delta channel network.
This class inherets all the attributes and methods of the rivnetwork class,
but also includes delta-specific attributes and methods.</p>
<dl class="attribute">
<dt id="rivgraph.classes.delta.Iskel">
<code class="descname">Iskel</code><a class="headerlink" href="#rivgraph.classes.delta.Iskel" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the skeletonized binary mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.delta.topo_metrics">
<code class="descname">topo_metrics</code><a class="headerlink" href="#rivgraph.classes.delta.topo_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a number of connectivity and network metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the delta channel network; also defines the folder name for storing results.</p></li>
<li><p><strong>path_to_mask</strong> (<em>str</em>) – Points to the channel network mask file path</p></li>
<li><p><strong>results_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies a directory where results should be stored</p></li>
<li><p><strong>verbose</strong> (<em>str</em><em>, </em><em>optional</em>) – RivGraph will output processing progress if ‘True’. Default is ‘False’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.assign_flow_directions">
<code class="descname">assign_flow_directions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.assign_flow_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.assign_flow_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes flow directions for each link in the delta channel network.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.compute_topologic_metrics">
<code class="descname">compute_topologic_metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.compute_topologic_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.compute_topologic_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a suite of connectivity and network metrics for a delta channel network.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.prune_network">
<code class="descname">prune_network</code><span class="sig-paren">(</span><em>path_shoreline=None</em>, <em>path_inletnodes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.prune_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.prune_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Prunes the delta by removing spurs and links beyond the provided shoreline.
Paths may be provided to shoreline and inlet nodes shapefiles, otherwise
their location is specified by paths dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_shoreline</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to shoreline shapefile/geosjon. The default is None but will
check for the file at <cite>paths[‘shoreline’]</cite>.</p></li>
<li><p><strong>path_inletnodes</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to inlet nodes shapefile/geojson. The default is None but will
check for the file at <cite>paths[‘inlet_nodes’]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None, but saves pruned links and nodes dictionaries to class object.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.skeletonize">
<code class="descname">skeletonize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.skeletonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.skeletonize" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes the delta binary mask.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rivgraph.classes.river">
<em class="property">class </em><code class="descclassname">rivgraph.classes.</code><code class="descname">river</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to manage and organize data and methods for analyzing a braided river channel network.
This class inherets all the attributes and methods of the rivnewtwork class, but also includes delta-specific attributes and methods.</p>
<dl class="attribute">
<dt id="rivgraph.classes.river.Iskel">
<code class="descname">Iskel</code><a class="headerlink" href="#rivgraph.classes.river.Iskel" title="Permalink to this definition">¶</a></dt>
<dd><p>Image of the skeletonized binary mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.topo_metrics">
<code class="descname">topo_metrics</code><a class="headerlink" href="#rivgraph.classes.river.topo_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a number of connectivity and network metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.centerline">
<code class="descname">centerline</code><a class="headerlink" href="#rivgraph.classes.river.centerline" title="Permalink to this definition">¶</a></dt>
<dd><p>Centerline of the holes-filled river channel network mask. First element in tuple are x-coordinates; second are y-coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of two numpy.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.centerline_smooth">
<code class="descname">centerline_smooth</code><a class="headerlink" href="#rivgraph.classes.river.centerline_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>A smooth version of centerline</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>shapely.geometry.LineString</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.max_valley_width_pixels">
<code class="descname">max_valley_width_pixels</code><a class="headerlink" href="#rivgraph.classes.river.max_valley_width_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum valley width in pixels, defined by widths along the centerline</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.width_chans">
<code class="descname">width_chans</code><a class="headerlink" href="#rivgraph.classes.river.width_chans" title="Permalink to this definition">¶</a></dt>
<dd><p>Average channel width</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.width_extent">
<code class="descname">width_extent</code><a class="headerlink" href="#rivgraph.classes.river.width_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Average width of the holes-filled channel mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.meshlines">
<code class="descname">meshlines</code><a class="headerlink" href="#rivgraph.classes.river.meshlines" title="Permalink to this definition">¶</a></dt>
<dd><p>The lines of the mesh that are perpendicular to the local river direction</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of shapely.geometry.LineString</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.meshpolys">
<code class="descname">meshpolys</code><a class="headerlink" href="#rivgraph.classes.river.meshpolys" title="Permalink to this definition">¶</a></dt>
<dd><p>Polygons comprising the along-channel mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of shapely.geometry.Polygon</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.skeletonize">
<code class="descname">skeletonize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.skeletonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.skeletonize" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes the river binary mask; uses a different method than for deltas.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.prune_network">
<code class="descname">prune_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.prune_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.prune_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Prunes the river channel network by removing spurs.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.compute_centerline">
<code class="descname">compute_centerline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_centerline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.compute_centerline" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the centerline of the holes-filled river channel network mask.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.compute_mesh">
<code class="descname">compute_mesh</code><span class="sig-paren">(</span><em>grid_spacing=None</em>, <em>smoothing=0.1</em>, <em>bufferdist=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.compute_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a mesh that follows the channel centerline; grid_spacing sets the length of each grid cell; bufferdist sets the width of each grid cell.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.assign_flow_direcions">
<code class="descname">assign_flow_direcions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rivgraph.classes.river.assign_flow_direcions" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes flow directions for each link in the delta channel network.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.set_flow_dirs_manually">
<code class="descname">set_flow_dirs_manually</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rivgraph.classes.river.set_flow_dirs_manually" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a user-created .csv file found at <cite>paths[‘fixlinks_csv’]</cite> to set flow directions of specified links.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a channelnetwork class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the channel network; also defines the folder name for
storing results.</p></li>
<li><p><strong>path_to_mask</strong> (<em>str</em>) – Points to the channel network mask file path</p></li>
<li><p><strong>results_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies a directory where results should be stored</p></li>
<li><p><strong>exit_sides</strong> (<em>str</em><em>, </em><em>optional</em>) – Only required for river channel netowrks. A two-character string
(from N, E, S, or W) that denotes which sides of the image the
river intersects (upstream first) – e.g. ‘NS’, ‘EW’, ‘NW’, etc.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, print run information and warnings to the console, default
is False.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="rivgraph.classes.river.name">
<code class="descname">name</code><a class="headerlink" href="#rivgraph.classes.river.name" title="Permalink to this definition">¶</a></dt>
<dd><p>the name of the channel network, usually the river or delta’s name</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.verbose">
<code class="descname">verbose</code><a class="headerlink" href="#rivgraph.classes.river.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>[True] or False to specify if processing updates should be printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.d">
<code class="descname">d</code><a class="headerlink" href="#rivgraph.classes.river.d" title="Permalink to this definition">¶</a></dt>
<dd><p>object created by gdal.Open() that provides access to geotiff
metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>osgeo.gdal.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.mask_path">
<code class="descname">mask_path</code><a class="headerlink" href="#rivgraph.classes.river.mask_path" title="Permalink to this definition">¶</a></dt>
<dd><p>filepath to the input binary channel network mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.imshape">
<code class="descname">imshape</code><a class="headerlink" href="#rivgraph.classes.river.imshape" title="Permalink to this definition">¶</a></dt>
<dd><p>dimensions of the image (rows, cols)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.gt">
<code class="descname">gt</code><a class="headerlink" href="#rivgraph.classes.river.gt" title="Permalink to this definition">¶</a></dt>
<dd><p>gdal-type Geotransform of the input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.wkt">
<code class="descname">wkt</code><a class="headerlink" href="#rivgraph.classes.river.wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>well known text representation of coordinate reference system of
input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.epsg">
<code class="descname">epsg</code><a class="headerlink" href="#rivgraph.classes.river.epsg" title="Permalink to this definition">¶</a></dt>
<dd><p>epsg code of the coordinate reference system of input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.unit">
<code class="descname">unit</code><a class="headerlink" href="#rivgraph.classes.river.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>units of the coordinate reference system; typically ‘degree’ or
‘meter’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.pixarea">
<code class="descname">pixarea</code><a class="headerlink" href="#rivgraph.classes.river.pixarea" title="Permalink to this definition">¶</a></dt>
<dd><p>area of each pixel, in units of ‘unit’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.pixlen">
<code class="descname">pixlen</code><a class="headerlink" href="#rivgraph.classes.river.pixlen" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each pixel, assumes sides are equal-length</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.paths">
<code class="descname">paths</code><a class="headerlink" href="#rivgraph.classes.river.paths" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary of strings for managing where files should be
read/written</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.exit_sides">
<code class="descname">exit_sides</code><a class="headerlink" href="#rivgraph.classes.river.exit_sides" title="Permalink to this definition">¶</a></dt>
<dd><p>two-character string denoting which sides of the image the channel
network intersects (N,E,S, and/or W). Upstream side should be given
first.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.Imask">
<code class="descname">Imask</code><a class="headerlink" href="#rivgraph.classes.river.Imask" title="Permalink to this definition">¶</a></dt>
<dd><p>binary mask found at mask_path loaded into a numpy array via
<cite>gdal.Open().ReadAsArray()</cite>, dtype=np.bool</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.links">
<code class="descname">links</code><a class="headerlink" href="#rivgraph.classes.river.links" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the links of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.nodes">
<code class="descname">nodes</code><a class="headerlink" href="#rivgraph.classes.river.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the nodes of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.Idist">
<code class="descname">Idist</code><a class="headerlink" href="#rivgraph.classes.river.Idist" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the distance transform of the binary mask, dtype=np.float</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.assign_flow_directions">
<code class="descname">assign_flow_directions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.assign_flow_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.assign_flow_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically sets flow directions for each link in a braided river
channel network.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_centerline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_centerline"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Computes the centerline of the holes-filled river binary image.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_mesh</code><span class="sig-paren">(</span><em>grid_spacing=None</em>, <em>smoothing=0.1</em>, <em>buf_halfwidth=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_mesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generates an along-centerline mesh that indicates a valley-direction
of sorts. The mesh is useful for computing spatial statistics as a function
of downstream distance. The resulting mesh captures the low-frequency
characteristic of the river corridor.</p>
<p>This tool is tricky to fully automate, and the user may need to play
with the smoothing and bufferdist parameters if errors are thrown or
the result is not satisfying.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_spacing</strong> (<em>float</em>) – Defines the distance between perpendicular-to-centerline transects.
Units are defined by input mask CRS.</p></li>
<li><p><strong>smoothing</strong> (<em>float</em>) – Defines the smoothing window of the left- and right-valleylines as a fraction
of the total centerline length. Range is [0, 1].</p></li>
<li><p><strong>buf_halfwidth</strong> (<em>float</em>) – Defines the offset distance of the left- and right-valleylines from
from the centerline. Units correspond to those of the CRS of the
input mask.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">prune_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.prune_network"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Prunes the computed river network.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">skeletonize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.skeletonize"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Skeletonizes the river binary mask.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rivgraph.classes.rivnetwork">
<em class="property">class </em><code class="descclassname">rivgraph.classes.</code><code class="descname">rivnetwork</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Base rivnetwork class.</p>
<p>The rivnetwork class organizes data and methods for channel networks. This
is a parent class to the delta and river classes which inherit rivnetwork
methods and attributes. This class thus represents the common elements of
river and delta channel networks.</p>
<dl class="method">
<dt id="rivgraph.classes.rivnetwork.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a channelnetwork class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the channel network; also defines the folder name for
storing results.</p></li>
<li><p><strong>path_to_mask</strong> (<em>str</em>) – Points to the channel network mask file path</p></li>
<li><p><strong>results_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies a directory where results should be stored</p></li>
<li><p><strong>exit_sides</strong> (<em>str</em><em>, </em><em>optional</em>) – Only required for river channel netowrks. A two-character string
(from N, E, S, or W) that denotes which sides of the image the
river intersects (upstream first) – e.g. ‘NS’, ‘EW’, ‘NW’, etc.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, print run information and warnings to the console, default
is False.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.name">
<code class="descname">name</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.name" title="Permalink to this definition">¶</a></dt>
<dd><p>the name of the channel network, usually the river or delta’s name</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.verbose">
<code class="descname">verbose</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>[True] or False to specify if processing updates should be printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.d">
<code class="descname">d</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.d" title="Permalink to this definition">¶</a></dt>
<dd><p>object created by gdal.Open() that provides access to geotiff
metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>osgeo.gdal.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.mask_path">
<code class="descname">mask_path</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.mask_path" title="Permalink to this definition">¶</a></dt>
<dd><p>filepath to the input binary channel network mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.imshape">
<code class="descname">imshape</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.imshape" title="Permalink to this definition">¶</a></dt>
<dd><p>dimensions of the image (rows, cols)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.gt">
<code class="descname">gt</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.gt" title="Permalink to this definition">¶</a></dt>
<dd><p>gdal-type Geotransform of the input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.wkt">
<code class="descname">wkt</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>well known text representation of coordinate reference system of
input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.epsg">
<code class="descname">epsg</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.epsg" title="Permalink to this definition">¶</a></dt>
<dd><p>epsg code of the coordinate reference system of input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.unit">
<code class="descname">unit</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>units of the coordinate reference system; typically ‘degree’ or
‘meter’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.pixarea">
<code class="descname">pixarea</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.pixarea" title="Permalink to this definition">¶</a></dt>
<dd><p>area of each pixel, in units of ‘unit’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.pixlen">
<code class="descname">pixlen</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.pixlen" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each pixel, assumes sides are equal-length</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.paths">
<code class="descname">paths</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.paths" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary of strings for managing where files should be
read/written</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.exit_sides">
<code class="descname">exit_sides</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.exit_sides" title="Permalink to this definition">¶</a></dt>
<dd><p>two-character string denoting which sides of the image the channel
network intersects (N,E,S, and/or W). Upstream side should be given
first.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.Imask">
<code class="descname">Imask</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.Imask" title="Permalink to this definition">¶</a></dt>
<dd><p>binary mask found at mask_path loaded into a numpy array via
<cite>gdal.Open().ReadAsArray()</cite>, dtype=np.bool</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.links">
<code class="descname">links</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.links" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the links of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.nodes">
<code class="descname">nodes</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the nodes of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.Idist">
<code class="descname">Idist</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.Idist" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the distance transform of the binary mask, dtype=np.float</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.adjacency_matrix">
<code class="descname">adjacency_matrix</code><span class="sig-paren">(</span><em>weight=None</em>, <em>normalized=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.adjacency_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.adjacency_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the adjacency matrix for a graph defined by links and nodes
dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> (<em>str</em><em>, </em><em>optional</em>) – [None] or the attribute in the links dictionary to use for weighting links. Typically ‘wid_adj’ or ‘len’.</p></li>
<li><p><strong>normalized</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, each row in the adjacency matrix will sum to one. [False] by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>A</strong> – an NxN matrix representing the connectivity of the graph, where N
is the number of nodes in the network. See adjacency matrix for more details.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_distance_transform">
<code class="descname">compute_distance_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_distance_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_distance_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance transform of the channel network mask.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_junction_angles">
<code class="descname">compute_junction_angles</code><span class="sig-paren">(</span><em>weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_junction_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_junction_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the angle at nodes where only three links are connected.
Directions must be assigned before angles can be computed. Also defines
each 3-link node as ‘confluence’ or ‘bifurcation’ and appends this
designation to the nodes dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weight</strong> (<em>str</em>) – [None], ‘exp’ (exponential), or ‘lin’ (linear) to determine the
decay of the weights the contributions of pixels as we move away
from the junction node.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_link_width_and_length">
<code class="descname">compute_link_width_and_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_link_width_and_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_link_width_and_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes widths and lengths of each link in the links dictionary and
appends them as dictionary attributes.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_network">
<code class="descname">compute_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the links and nodes of the channel network mask.
First skeletonizes the mask if not already done, then resolves the
skeleton’s graph.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.get_islands">
<code class="descname">get_islands</code><span class="sig-paren">(</span><em>props=['area', 'maxwidth', 'major_axis_length', 'minor_axis_length', 'surrounding_links'], connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.get_islands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.get_islands" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the islands in the binary mask and computes their morphological
properties. Can be used to help “clean” masks of small islands. Must
run compute_network() first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>props</strong> (<em>list</em><em>, </em><em>optional</em>) – Properties to compute for each island. Properties can be any of those
provided by rivgraph.im_utils.regionprops.
The default is [‘area’, ‘maxwidth’, ‘major_axis_length’, ‘minor_axis_length’].</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>islands</strong> – Contains the polygons of each island with the requested property
attributes as columns. An additional ‘remove’ attribute is
initialized to make thresholding easier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geopandas GeoDataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.load_network">
<code class="descname">load_network</code><span class="sig-paren">(</span><em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.load_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.load_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the link and nodes dictionaries from a .pkl file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path–including extension–to network .pkl file. If [None], file
is loaded from path found in paths[‘network_pickle’]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*kwargs</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates matplotlib plots of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*kwargs</strong> (<em>str</em>) – If [None], both of the following plots will be generated:
‘network’: links and nodes are plotted, labeled with their ids
‘directions’: links are plotted with their directionality indicated</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.save_network">
<code class="descname">save_network</code><span class="sig-paren">(</span><em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.save_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.save_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the link and nodes dictionaries to a .pkl file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path–including extension–to network .pkl file. If [None], file
written to path found in paths[‘network_pickle’]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.to_geotiff">
<code class="descname">to_geotiff</code><span class="sig-paren">(</span><em>export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.to_geotiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.to_geotiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes geotiffs to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>export</strong> (<em>str</em>) – <dl class="simple">
<dt>Select a raster to write to geotiff. Choose from:</dt><dd><p>’directions’ - network burned into a raster with link directions from 0 (upstream) to 1 (downstream))
‘skeleton’  - skeletonized mask
‘distance’ - distance-transformed mask</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.to_geovectors">
<code class="descname">to_geovectors</code><span class="sig-paren">(</span><em>export='network'</em>, <em>ftype='json'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.to_geovectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.to_geovectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the links and nodes of the network to geovectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>export</strong> (<em>str</em>) – <p>Determines which features to export. Choose from:</p>
<ul>
<li><p>all (exports all available vector data)</p></li>
<li><p>network (links and nodes)</p></li>
<li><p>links</p></li>
<li><p>nodes</p></li>
<li><p>centerline (river classes only)</p></li>
<li><p>mesh (centerline mesh, river classes only)</p></li>
<li><p>centerline_smooth (river classes only)</p></li>
</ul>
</p></li>
<li><p><strong>ftype</strong> (<em>str</em>) – <p>Sets the output file format. Choose from:</p>
<ul>
<li><p>json (GeoJSON)</p></li>
<li><p>shp  (ESRI Shapefile)</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-rivgraph.directionality"></span><div class="section" id="directionality-utilities-directionality-py">
<h2>Directionality Utilities (directionality.py)<a class="headerlink" href="#directionality-utilities-directionality-py" title="Permalink to this headline">¶</a></h2>
<p>Created on Wed Nov  7 11:38:16 2018
&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.directionality.add_directionality_trackers">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">add_directionality_trackers</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>ntype</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#add_directionality_trackers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.add_directionality_trackers" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds fields to the links and nodes dictionaries that are required for
setting and diagnosing directionality. Nodes are not altered in this
function, but passed for consistency and generalizability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>ntype</strong> (<em>str</em>) – Network type. Choose either ‘delta’ or ‘river’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with added directionality properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.algmap">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">algmap</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#algmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.algmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a numeric key corresponding to each algorithm used by RivGraph to
set link directionality. These numbers are found in links[‘guess_alg’] and
links[‘certain_alg’] and are useful for diagnosing issues in setting
directionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – See the mapper below for the possible keywords.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>algno</strong> – Numeric representation of direction-setting algorithm.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.check_continuity">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">check_continuity</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#check_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.check_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all sinks or sources within the network, excluding inlets and outlets.
Returns any nodes where continuity is violated. Only checks nodes for whom
all attached links are certain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>problem_nodes</strong> – Node ids corresponding to nodes[‘id’] where continuity is violated.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.cycle_get_original_orientation">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">cycle_get_original_orientation</code><span class="sig-paren">(</span><em>links</em>, <em>lids</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#cycle_get_original_orientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.cycle_get_original_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the orientation of a set of links. Used before attempting to fix
cycles. Properties besides ‘conn’ must also be reversed, so their original
orientations are also stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>lids</strong> (<em>list</em>) – Link ids whose orientations should be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>orig</strong> – A subset of the links dictionary containing the orientations of each
link in lids.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.cycle_return_to_original_orientation">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">cycle_return_to_original_orientation</code><span class="sig-paren">(</span><em>links</em>, <em>orig</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#cycle_return_to_original_orientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.cycle_return_to_original_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of links to its original orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>orig</strong> (<em>dict</em>) – Network links and associated properties to return to original
orientations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network links and associated properties in their original orientations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_bridges">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_bridges</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_bridges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_bridges" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses directionality of bridge links. Bridge links are those which flow
must pass through to reach the outlet; in other words, if a bridge link is
removed from the network, there will no longer be just one connected
network. Directionality is inferred by consideration of which subnetwork
(after removing the bridge link) contains inlet and outlet nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_known_link_angles">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_known_link_angles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>dims</em>, <em>checklinks='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_known_link_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_known_link_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses directionality for unknown links whose immediately adjacent links’
directionalities are known. Computes the angle of “flow” between outlet and
inlet end nodes for each neighboring link, then sets the unknown link
such that its orientation minimizes the error between its neighbors and
itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – Shape of the input mask as (nrows, ncols).</p></li>
<li><p><strong>checklinks</strong> (<em>list OR str</em><em>, </em><em>optional</em>) – A list of link ids can be provided to check only specific links.
Otherwise, the default is ‘all’ which checks all links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_main_channel">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_main_channel</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_main_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_main_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses directionality of links based on shortest paths from widest inlet
link to all the outlet links. Links are also weighted by width, such that
deviations from the “main channel” width cost more to traverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_set_manually">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_set_manually</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>manual_set_csv</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_set_manually"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_set_manually" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets link directions based on a user-provided csv-file. The csv file has
exactly two columns; one called ‘link_id’, and one called ‘usnode’.
This file can be created automatically by the function
io_utils.create_manual_dir_csv().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>manual_set_csv</strong> (<em>str</em>) – Path to csv defining which links have which upstream nodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with specified links set
manually.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with specified links set
manually.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_shortest_paths_links">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_shortest_paths_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>difthresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_shortest_paths_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_shortest_paths_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses a link’s directionality by which of its endpoint nodes is
closer to the nearest outlet (or preoutlet). “difthresh” refers to the
difference in distances between endpoint nodes; higher means directionality
is less likely to be ascertained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>difthresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Threshold for the length (in number of nodes) that must be surpassed
between an unknown link’s endpoints for directionality to be set.
Lengths are measured from the link’s endpoints to the nearest
outlet (or preoutlet). The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_shortest_paths_nodes">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_shortest_paths_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_shortest_paths_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_shortest_paths_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses link directionality based on the shortest path from its end
nodes to the nearest outlet (or pre-outlet). For each unknown link, if the
path flows through the link attached to the node (as opposed to immediately
away from the link), its directionality is set; otherwise nothing
is done. Note that this will not set all links’ directionalities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.find_a_cycle">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">find_a_cycle</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#find_a_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.find_a_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a single cycle in the network. Multiple cycles may exist; this
function returns only the first one encountered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cycle_nodes</strong> (<em>list</em>) – Node ids comprising the cycle. Arranged in order of cycle.</p></li>
<li><p><strong>cycle_links</strong> (<em>list</em>) – Link ids comprising the cycle. Arranged in order of cycle.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.fix_cycles">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">fix_cycles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#fix_cycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.fix_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to remove all cycles in the directed graph. A number of approaches
are tried, and if any of them result in a source/sink node or a cycle,
another approach is attempted until the cycle is resolved or we run out
of approaches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with all possible cycles
resolved.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with all possible cycles
resolved</p></li>
<li><p><strong>n_cycles_remaining</strong> (<em>int</em>) – Number of cycles that were unresolvable.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.fix_sources_and_sinks">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">fix_sources_and_sinks</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#fix_sources_and_sinks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.fix_sources_and_sinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes sources and sinks within the network by flipping link directionality
near the problem node(s). The links to flip are chosen by ensuring they do
not create a cycle; if multiple links can be flipped, the shortest one is
chosen. If no solution is found, links are returned to their original
orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with sources/sinks fixed if
possible.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network links and associated properties with sources/sinks fixed if
possible.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.flip_links_in_G">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">flip_links_in_G</code><span class="sig-paren">(</span><em>G</em>, <em>links2flip</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#flip_links_in_G"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.flip_links_in_G" title="Permalink to this definition">¶</a></dt>
<dd><p>Flips the directionality of links in a networkx graph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>G</strong> (<em>networkx.Graph</em><em> or </em><em>similar</em>) – Graph object representing the network.</p></li>
<li><p><strong>links2flip</strong> (<em>tuple or</em>) – An Nx2 tuple containing the US and DS node ids of the edge (link) to
flip.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>G</strong> – Graph object representing the network with the requested links flipped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>networkx.Graph or similar</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.get_cycles">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">get_cycles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>checknode='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#get_cycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.get_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds either all cycles in the network or cycles containing the checknode’th
node. Cycles are returned as both nodes and links.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>checknode</strong> (<em>int OR str</em><em>, </em><em>optional</em>) – ID of node to check for its inclusion in any cycles. If the default
value ‘all’ is selected, all cycles will be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cycle_nodes</strong> (<em>list of lists</em>) – List containing lists of all cycles found in the network; cycles are
returned in cyclic order and in terms of node ids.</p></li>
<li><p><strong>cycles_links</strong> (<em>TYPE</em>) – List containing lists of all cycles found in the network; cycles are
returned in cyclic order and in terms of link ids.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.get_link_vector">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">get_link_vector</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>linkid</em>, <em>imshape</em>, <em>pixlen=1</em>, <em>normalized=True</em>, <em>trim=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#get_link_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.get_link_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the normalized vector of a link that indicates the direction of
flow through a link based on its connectivity. This function will first trim
the link by its endpoint (half)width values to mitigate cases where where wide
channels are connected to narrow channels.</p>
<p>Requires a link contain at least min_len_for_trim pixels post-trimming.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>linkid</strong> (<em>int</em>) – ID of the link correspoinding to those found in links[‘id’].</p></li>
<li><p><strong>imshape</strong> (<em>tuple</em>) – Shape of the binary mask as (nrows, ncols).</p></li>
<li><p><strong>pixlen</strong> (<em>float</em><em>, </em><em>optional</em>) – Length resolution of each pixel. The default is 1.</p></li>
<li><p><strong>normalized</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will return a vector on [-1, 1]. The default is True.</p></li>
<li><p><strong>trim</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, links will be trimmed to remove possibly direction-biasing
end segments. If False, the untrimmed link endpoints will define the
vector direction. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>link_vec</strong> – Two-element array describing the x and y components of the direction
vector describing the link.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.merge_list_of_lists">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">merge_list_of_lists</code><span class="sig-paren">(</span><em>inlist</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#merge_list_of_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.merge_list_of_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges a list of lists into a single list, but removes duplicates.
Uses networkx and itertools for a fun solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inlist</strong> (<em>list of lists</em>) – List of lists to merge without dulplicates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>merged</strong> – List of length equal to number of unique entries across all lists of
inlist.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.nodepath_to_links">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">nodepath_to_links</code><span class="sig-paren">(</span><em>path</em>, <em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#nodepath_to_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.nodepath_to_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a path defined by node ids to a path defined by link ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>list</em>) – Node ids comprising a path within the network.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>linkpath</strong> – Link ids comprising the path defined by the given node ids.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_artificial_nodes">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_artificial_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>checknodes='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_artificial_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_artificial_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is deprecated as of v0.3 and is no longer called.</p>
<p>Set the directionality of links where aritificial nodes were added. For such
loops, flow will travel the same way through both sides of the loop (to avoid
cycles). Therefore, if one side is known, we can set the other side.
Method 1 sets a broken link if its counterpart is known.
Method 2 sets a side of the loop if the other side is known.
Method 3 sets both sides if the input to one of the end nodes is known.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>checknodes</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Node ids to check for presence of settable artificial links. If ‘all’,
all nodes in the network are checked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_by_known_flow_directions">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_by_known_flow_directions</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>imshape</em>, <em>angthresh=2</em>, <em>lenthresh=0</em>, <em>nknown_thresh=1</em>, <em>alg=6</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_by_known_flow_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_by_known_flow_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets unknown link directions by determining which flow direction through
the link minimizes the overall change in flow direction at the connecting
nodes. For a set of links connected to a node, at least one of the links’
directions must be known for this algorithm to be effective. Links are
set from longest to shortest, as longer links generally have less
uncertainty associated with their directions.</p>
<p>A number of thresholds are provided as options to control the power of
the algorithm. This function should generally be applied iteratively,
beginning with the most restrictive thresholds and gradually relaxing
them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>imshape</strong> (<em>tuple</em>) – Shape of the binary mask as (nrows, ncols).</p></li>
<li><p><strong>angthresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Angle in radians to determine if an unknown link is parallel enough to
its connected known links to set its direction. The default is 2.</p></li>
<li><p><strong>lenthresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Length in pixels of the minimum link length required to use this
algorithm to set its directionality. The default is 0.</p></li>
<li><p><strong>nknown_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of known connected links required to use this algorithm to
set the unknown link’s directionality. The default is 1.</p></li>
<li><p><strong>alg</strong> (<em>float</em><em>, </em><em>optional</em>) – Algorithm ID to assign to the set link. The default is 6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_by_nearest_main_channel">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_by_nearest_main_channel</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>imshape</em>, <em>nodethresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_by_nearest_main_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_by_nearest_main_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all possible links’ directions using the nearest main channel. The
main channels are found as the widest, shortest paths from each inlet to
each outlet. For each unknown link, the distance is computed from its
endpoints to the nearest nodes of the nearest main channel. If the nearest
nodes of the main channel include more than 2 + nodethresh nodes, the
direction of the main channel is used to set the unknown link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>imshape</strong> (<em>tuple</em>) – Shape of binary mask as (nrows, ncols).</p></li>
<li><p><strong>nodethresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Threshold for the number of nodes along the nearest main channel that
must be encompassed by the unknown link’s endnodes to confidently
set the unknown link’s direction. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_continuity">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_continuity</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>checknodes='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets link directions by enforce continuity at each node such that there
are no sources or sinks within the network. Iterates until no more links
directions can be set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>checknodes</strong> (<em>list OR str</em><em>, </em><em>optional</em>) – Each link connected to each node id in this list will be checked for
continuity. All nodes will be checked if using the default value ‘all’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_inletoutlet">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_inletoutlet</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_inletoutlet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_inletoutlet" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets directions of links that are connected to inlets and outlets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_link">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_link</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>linkidx</em>, <em>usnode</em>, <em>alg=9999</em>, <em>checkcontinuity=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a link directionality. Option to check for continuity (including
parallel links) after setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>linkidx</strong> (<em>int</em>) – Index of link within links[‘id’] to set. This index can be found from
the link id via links[‘id’].index(linkid).</p></li>
<li><p><strong>usnode</strong> (<em>int</em>) – Node id of the upstream node.</p></li>
<li><p><strong>alg</strong> (<em>int</em><em>, </em><em>optional</em>) – The algorithm id used to set the link. Used for diagnostic purposes and
fixing cycles. The default is 9999.</p></li>
<li><p><strong>checkcontinuity</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, checks nearby links for continuity and parallel links after
setting the link’s direction. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with updated link direction.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with updated link direction.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_parallel_links">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_parallel_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>knownlink</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_parallel_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_parallel_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets directionality of parallel links. If two links are parallel, they
share the same end nodes. If the direction of one of the links is known,
the other must be set in a direction to avoide creating a cycle within
the graph. This function thus prevents cycles from being created and in
general should be run after any link direction is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>knownlink</strong> (<em>int</em>) – Link id of link whose direction has been set to check for parallel
links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.widest_inlet_index">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">widest_inlet_index</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#widest_inlet_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.widest_inlet_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the index of the inlet occurring at the widest link. Index is with
respect to the nodes[‘id’] list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>inlet_idx</strong> – Index of the inlet node of the widest link.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.geo_utils"></span><div class="section" id="georeferencing-utilities-geo-utils-py">
<h2>Georeferencing Utilities (geo_utils.py)<a class="headerlink" href="#georeferencing-utilities-geo-utils-py" title="Permalink to this headline">¶</a></h2>
<p>Utilities for reading, writing, managing, processing, manipulating, etc.
geographic data including tiffs, vrts, shapefiles, etc.</p>
<p>6/2/2020 - Consider merging this into io_utils and im_utils. Not much actual
functionality here, and some of these functions are simply unused.</p>
<dl class="function">
<dt id="rivgraph.geo_utils.coords_to_xy">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">coords_to_xy</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>gt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#coords_to_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.coords_to_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of xs, ys in projected coordinates to rows, columns within
a geotiff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>list</em><em> or </em><em>np.array</em><em>(</em><em>)</em>) – Specifies the E-W coordinates (longitude).</p></li>
<li><p><strong>ys</strong> (<em>list</em><em> or </em><em>np.array</em><em>(</em><em>)</em>) – Specifies the N-S coordinates (latitude).</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – 6-element tuple gdal GeoTransform.
(uL_x, x_res, rotation, ul_y, rotation, y_res).
Automatically created by gdal’s GetGeoTransform() method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rowcols</strong> – Nx2 array of (row, col) indices corresponding to the inpute coordinates. N = len(xs).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.crop_geotif">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">crop_geotif</code><span class="sig-paren">(</span><em>tif</em>, <em>cropto='first_nonzero'</em>, <em>npad=0</em>, <em>outpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#crop_geotif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.crop_geotif" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a geotiff to the minimum bounding box as defined by the first
nonzero pixels along each direction. The cropped image is written to
disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tif</strong> (<em>str</em>) – Path to geotiff to crop.</p></li>
<li><p><strong>cropto</strong> (<em>str</em>) – [first_nonzero] is currently the only choice.</p></li>
<li><p><strong>npad</strong> (<em>int</em>) – Number of pixels to add to each direction of the cropped image.</p></li>
<li><p><strong>outpath</strong> (<em>str</em>) – Defines the path where the cropped image will be written to disk. If
[None], the file will be written to the same directory as the input
geotiff.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_file</strong> – Path to the saved, cropped geotiff.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.downsample_binary_geotiff">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">downsample_binary_geotiff</code><span class="sig-paren">(</span><em>input_file</em>, <em>ds_factor</em>, <em>output_name</em>, <em>thresh=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#downsample_binary_geotiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.downsample_binary_geotiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Given binary geotiff, create a downsampled one.</p>
<p>Use <a class="reference internal" href="#rivgraph.im_utils.downsample_binary_image" title="rivgraph.im_utils.downsample_binary_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rivgraph.im_utils.downsample_binary_image()</span></code></a> and a bunch of
gdal bits to downsample a binary geotiff file to the specified relative
resolution. This new geotiff will have properly associated geoinformation
etc.
(to downsample a 2D array use the aforementioned function in im_utils).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> (<em>str</em>) – Path to input file (original geotiff) as a string</p></li>
<li><p><strong>ds_factor</strong> (<em>float</em>) – Downsampling factor. This is the relative resolution for the output
file. For example, to downsample to half of the resolution of the
original image, ds_factor should be set to 0.5. As this function is
for downsample, values &gt;= 1 are invalid.</p></li>
<li><p><strong>output_name</strong> (<em>str</em>) – Path / output file name, should have extension .tif</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Optional input to <a class="reference internal" href="#rivgraph.im_utils.downsample_binary_image" title="rivgraph.im_utils.downsample_binary_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rivgraph.im_utils.downsample_binary_image()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_name</strong> – Path to the saved, downsampled geotiff.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.geotiff_vals_from_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">geotiff_vals_from_coords</code><span class="sig-paren">(</span><em>coords</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#geotiff_vals_from_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.geotiff_vals_from_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns pixel values at specific coordinates from a geotiff object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.array</em><em>(</em><em>)</em>) – An Nx2 numpy array, where each row is a (lon, lat) pair.</p></li>
<li><p><strong>gd_obj</strong> (<em>osgeo.gdal.Dataset</em>) – Geotiff object created with gdal.Open().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vals</strong> – The value of the pixels of the geotiff for each coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.get_unit">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">get_unit</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#get_unit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.get_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the units for a projection defined by an EPSG code.
See <a class="reference external" href="https://en.wikibooks.org/wiki/PROJ.4#Units">https://en.wikibooks.org/wiki/PROJ.4#Units</a> for a list of unit string
maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>crs</strong> (<em>pyproj CRS object</em>) – Defines the coordinate reference system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>unit</strong> – The unit of the provided epsg code.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.idx_to_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">idx_to_coords</code><span class="sig-paren">(</span><em>idx</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#idx_to_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.idx_to_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of indices from a geotiff image to their corresponding
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>np.array</em><em>(</em><em>)</em>) – Specifies the indices to transform. See np.ravel_index for more info.</p></li>
<li><p><strong>gd_obj</strong> (<em>osego.gdal.Dataset</em>) – gdal object of the geotiff from which indices were computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cx, cy</strong> – x and y coordinates of the provided indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.transform_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">transform_coords</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>inputEPSG</em>, <em>outputEPSG</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#transform_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.transform_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of coordinates from one epsg to another.
This implementation differs from above by using pyproj.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>np.array</em>) – Specifies the x-coordinates to transform.</p></li>
<li><p><strong>ys</strong> (<em>np.array</em>) – Specifies the y-coordinates to transform.</p></li>
<li><p><strong>inputEPSG</strong> (<em>int</em>) – epsg code corresponding to xs, ys</p></li>
<li><p><strong>outputEPSG</strong> (<em>int</em>) – epsg code corresponding to desired CRS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xy</strong> – Two element array of transformed (x, y) coordinates. xy[0] are
transformed x coordinates, xy[1] are transformed y coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.xy_to_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">xy_to_coords</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>gt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#xy_to_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.xy_to_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of x and y coordinates to their corresponding coordinates
within a geotiff image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>np.array</em>) – Specifies the x-coordinates to transform.</p></li>
<li><p><strong>ys</strong> (<em>np.array</em>) – Specifies the y-coordinates to transform.</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – 6-element tuple gdal GeoTransform.
(uL_x, x_res, rotation, ul_y, rotation, y_res).
Automatically created by gdal’s GetGeoTransform() method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cx, cy</strong> – Column and row indices of the provided coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.im_utils"></span><div class="section" id="image-utilities-im-utils-py">
<h2>Image Utilities (im_utils.py)<a class="headerlink" href="#image-utilities-im-utils-py" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Almost all the functions that manipulate images within this file require that the images be binary.</p>
</div>
<p>Many of these functions are wrappers around functionality found in skimage or
opencv that either add additonal functionality or provide convenience.</p>
<dl class="function">
<dt id="rivgraph.im_utils.blob_idcs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">blob_idcs</code><span class="sig-paren">(</span><em>I</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#blob_idcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.blob_idcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the indices for each blob within I.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image containing blobs.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idcs</strong> – An n-element list of sets, where n is the number of blobs in I, and
each set contains the pixel indices within I of a blob.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.bp_kernels">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">bp_kernels</code><span class="sig-paren">(</span><em>caseno</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#bp_kernels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.bp_kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides kernels for convolving with branchpoints image to remove special
cases (where three branchpoints make an “L” shape). There are 8 possible
orientations (caseno’s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>caseno</strong> (<em>int</em>) – Identifier for specific kernel cases. Can be 1-8.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kernel</strong> – 3x3 kernel corresponding to the caseno.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.crop_binary_coords">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">crop_binary_coords</code><span class="sig-paren">(</span><em>coords</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#crop_binary_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.crop_binary_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops an array of (row, col) coordinates (e.g. blob indices) to the smallest
possible array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> (<em>np.array</em>) – N x 2 array. First column are rows, second are columns of pixel coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Image of the cropped coordinates, plus padding if desired.</p></li>
<li><p><strong>clipped</strong> (<em>list</em>) – Number of pixels in [left, top, right, bottom] direction that were
clipped.  Clipped returns the indices within the original coords image
that define where I should be positioned within the original image.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.crop_binary_im">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">crop_binary_im</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#crop_binary_im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.crop_binary_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a binary image to the smallest bounding box containing all the “on”
pixels in the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.array</em>) – Binary image to crop.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Icrop</strong> (<em>np.array</em>) – The cropped binary image.</p></li>
<li><p><strong>pads</strong> (<em>list</em>) – Four element list containing the number of pixels that were cropped
from the [left, top, right, bottom] of I.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.dilate">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">dilate</code><span class="sig-paren">(</span><em>I</em>, <em>n=1</em>, <em>strel='square'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#dilate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.dilate" title="Permalink to this definition">¶</a></dt>
<dd><p>Dilates a binary image using a specified kernel shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to dilate.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times to apply the dilating kernel. The default is 1.</p></li>
<li><p><strong>strel</strong> (<em>str</em><em>, </em><em>optional</em>) – Kernel shape. Follows skimage’s options, but only ‘square’, ‘plus’, and
‘disk’ are supported. The default is ‘square’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Id</strong> – Dilated binary image. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.downsample_binary_image">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">downsample_binary_image</code><span class="sig-paren">(</span><em>I</em>, <em>newsize</em>, <em>thresh=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#downsample_binary_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.downsample_binary_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an input binary image and a new size, this downsamples (i.e. reduces
resolution) the input image to the new size. A pixel is considered “on”
in the new image if ‘thresh’ fraction of its area is covered by the
higher-res image. E.g. set ‘thresh’ to zero if you want the output image
to be “on” everywhere at least a single pixel is “on” in the original
image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to downsample.</p></li>
<li><p><strong>newsize</strong> (<em>tuple</em>) – Two entry tuple (nrows, ncols) specifying the desired shape of the
image.</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – The fraction of filled area that downsampled pixels must have to
consider them on. Setting to 0 is the equialent of “all touched”.
The default is 0.05.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iout</strong> – The downsampled image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.edge_coords">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">edge_coords</code><span class="sig-paren">(</span><em>sizeI</em>, <em>dtype='flat'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#edge_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.edge_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an image size, returns the coordinates of all the edge pixels (4 edges).
Can return as indices (dtype=flat) or x,y coordinates (dtype=’xy’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sizeI</strong> (<em>tuple</em>) – Shape of the image.</p></li>
<li><p><strong>dtype</strong> (<em>str</em><em>, </em><em>optional</em>) – If ‘flat’, returns output as indices within I. If ‘xy’, returns (col, row)
of edge pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>edgepts</strong> – Coordinates of the edge pixels. If dtype==’flat’, returns a set. If
dtype==’xy’, returns a list of [columns, rows].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set or list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.erode">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">erode</code><span class="sig-paren">(</span><em>I</em>, <em>n=1</em>, <em>strel='square'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#erode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.erode" title="Permalink to this definition">¶</a></dt>
<dd><p>Erodes a binary image using a specified kernel shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to erode.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times to apply the eroding kernel. The default is 1.</p></li>
<li><p><strong>strel</strong> (<em>str</em><em>, </em><em>optional</em>) – Kernel shape. Follows skimage’s options, but only ‘square’, ‘plus’, and
‘disk’ are supported. The default is ‘square’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ie</strong> – Eroded binary image. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.fill_holes">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">fill_holes</code><span class="sig-paren">(</span><em>I</em>, <em>maxholesize=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#fill_holes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.fill_holes" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills holes up to a specified size in a binary image. The boundary pixels
of the image are turned off before identifying holes so that holes created
by the edge of the image are not considered holes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p></li>
<li><p><strong>maxholesize</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum allowed hole size in pixels. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I</strong> – The holes-filled image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.four_conn">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">four_conn</code><span class="sig-paren">(</span><em>idcs</em>, <em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#four_conn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.four_conn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of 4-connected neighbors for a given flat index in I.
idcs must be a list, even if a single value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idcs</strong> (<em>list</em>) – Indices within I to find 4-connected neighbors.</p></li>
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fourconn</strong> – Number of four-connected neighbors for each index in idcs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.get_array">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">get_array</code><span class="sig-paren">(</span><em>idx</em>, <em>I</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#get_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.get_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sub-image of an input image, centered at a specified index within
the input image and a specified size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index within I on which to center the returned array. Can also be a
[row, col] list.</p></li>
<li><p><strong>I</strong> (<em>np.array</em>) – Image to pull from.</p></li>
<li><p><strong>size</strong> (<em>list</em>) – Two-entry list specifying the number of [rows, cols] to return from
I centered at idx.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>subimage</strong> (<em>np.array</em>) – The sub-image of I, centered at idx with shape specified by size.</p></li>
<li><p><strong>row</strong> (<em>int</em>) – The first row within I that the sub-image is drawn from.</p></li>
<li><p><strong>col</strong> (<em>int</em>) – The first column within I that the sub-image is drawn from.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.hand_clean">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">hand_clean</code><span class="sig-paren">(</span><em>I</em>, <em>action='erase'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#hand_clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.hand_clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows user to hand-draw regions of interest on a binary mask that can
either be filled (set to True) or erased (set to False). Only one polygon
can be drawn per call.</p>
<dl class="simple">
<dt>Interact with plot via the following:</dt><dd><p>left-click: save a vertex of the polygon
right-click: remove the last point (useful when zooming/panning)
enter key: stop recording points</p>
</dd>
</dl>
<p>Possible actions are ‘erase’ (default) and ‘fill’.</p>
<p>Requires matplotlib and Python Image Library (PIL), but they are imported
here so that this function can be imported independently of the script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to fill or erase with hand-drawn polygons.</p></li>
<li><p><strong>action</strong> (<em>str</em><em>, </em><em>optional</em>) – If ==’fill’, will fill the drawn region. If ==’erase’, will erase the
drawn region. The default is ‘erase’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I</strong> – The image with the hand-drawn polygon either filled or erased.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.im_connectivity">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">im_connectivity</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#im_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.im_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an image of 8-connectivity for an input image of all pixels in a
binary image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iret</strong> – Image of 8-connectivity count for each pixel in the input image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.imshowpair">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">imshowpair</code><span class="sig-paren">(</span><em>I1</em>, <em>I2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#imshowpair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.imshowpair" title="Permalink to this definition">¶</a></dt>
<dd><p>Overlays two binary images with a color scheme that shows their differences
and overlaps. Provides similar functionality to matlab’s imshowpair. Useful
for quick diagnostic of differences between two binary images.</p>
<p>This function will plot on current figure if it exists, else it will create
a new one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I1</strong> (<em>np.array</em>) – The first binary image.</p></li>
<li><p><strong>I2</strong> (<em>np.array</em>) – The second binary image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.largest_blobs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">largest_blobs</code><span class="sig-paren">(</span><em>I</em>, <em>nlargest=1</em>, <em>action='remove'</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#largest_blobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.largest_blobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides filtering for the largest blobs in a binary image. Can choose to
either keep or remove them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to filter.</p></li>
<li><p><strong>nlargest</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of blobs to filter. The default is 1.</p></li>
<li><p><strong>action</strong> (<em>str</em><em>, </em><em>optional</em>) – If ‘keep’, will keep the nlargest blobs. If ‘remove’, will remove the
nlargest blobs. The default is ‘remove’.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong> – The filtered image. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbor_idcs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbor_idcs</code><span class="sig-paren">(</span><em>c</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbor_idcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbor_idcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the column, row coordinats of all eight neighbors of a given
column and row.</p>
<p>Returns are ordered as</p>
<dl class="simple">
<dt>[0 1 2</dt><dd><p>3   4
5 6 7]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>int</em>) – Column.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cidcs</strong> (<em>list</em>) – Columns of the eight neighbors.</p></li>
<li><p><strong>ridcs</strong> (<em>TYPE</em>) – Rows of the eight neighbors.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbor_vals">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbor_vals</code><span class="sig-paren">(</span><em>I</em>, <em>c</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbor_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbor_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the neighbor values in I of a specified pixel coordinate. Handles
edge cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Image to draw values from.</p></li>
<li><p><strong>c</strong> (<em>int</em>) – Column defining pixel to find neighbor values.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row defining pixel to find neighbor values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vals</strong> – A flattened array of all the neighboring pixel values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbor_xy">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbor_xy</code><span class="sig-paren">(</span><em>c</em>, <em>r</em>, <em>idx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbor_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbor_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinates of a neighbor of a pixel given the index of the
desired neighbor. Indices should be provided according to</p>
<dl class="simple">
<dt>[0 1 2</dt><dd><p>3   4
5 6 7].</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>int</em>) – Column of the pixel to find the neighbor.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row of the pixel to find the neighbor.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – Index of the neighbor position.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c</strong> (<em>int</em>) – Column of the neighbor pixel.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row of the neighbor pixel.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbors_flat">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbors_flat</code><span class="sig-paren">(</span><em>idx</em>, <em>imflat</em>, <em>ncols</em>, <em>filt='nonzero'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbors_flat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbors_flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all 8-neighbor pixel indices and values from an index of a
flattened image. Can filter out zero values with the filt keyword.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index within imflat to return neighbors.</p></li>
<li><p><strong>imflat</strong> (<em>np.array</em>) – Flattened image (using np.ravel).</p></li>
<li><p><strong>ncols</strong> (<em>int</em>) – Number of columns in the un-flattened image.</p></li>
<li><p><strong>filt</strong> (<em>str</em><em>, </em><em>optional</em>) – If ‘nonzero’, only nonzero indices and values are returned. Else all
neighbors are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>idcs</strong> (<em>np.array</em>) – Indices within the flattened image of neighboring pixels.</p></li>
<li><p><strong>vals</strong> (<em>np.array</em>) – Values within the flattened image of neighboring pixels; matches idcs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.nfour_connectivity">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">nfour_connectivity</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#nfour_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.nfour_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an image of four-connectivity for each pixel, where the pixel value
is the number of 4-connected neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Infc</strong> – Image of 4-connectivity for each pixel. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.regionprops">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">regionprops</code><span class="sig-paren">(</span><em>I</em>, <em>props</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#regionprops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.regionprops" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds blobs within a binary image and returns requested properties of
each blob.</p>
<p>This function was modeled after matlab’s regionprops and is essentially
a wrapper for skimage’s regionprops. Not all of skimage’s available blob
properties are available here, but they can easily be added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image containing blobs.</p></li>
<li><p><strong>props</strong> (<em>list</em>) – Properties to compute for each blob. Can include ‘area’, ‘coords’,
‘perimeter’, ‘centroid’, ‘mean’, ‘perim_len’, ‘convex_area’,
‘eccentricity’, ‘major_axis_length’, ‘minor_axis_length’,
‘label’.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Keys of the dictionary correspond to the requested properties. Values
for each key are lists of that property, in order such that, e.g., the
first entry of each property’s list corresponds to the same blob.</p></li>
<li><p><strong>Ilabeled</strong> (<em>np.array</em>) – Image where each pixel’s value corresponds to its blob label. Labels
can be returned by specifying ‘label’ as a property.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.reglobalize_flat_idx">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">reglobalize_flat_idx</code><span class="sig-paren">(</span><em>idxlist</em>, <em>idxlistdims</em>, <em>row_offset</em>, <em>col_offset</em>, <em>globaldims</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#reglobalize_flat_idx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.reglobalize_flat_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of indices from a subimage and returns their indices within
their parent image.</p>
<p>If idxlist is (x,y), then idxlistdims should be (dim_x, dim_y), etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idxlist</strong> (<em>np.array</em><em> or </em><em>list</em><em> or </em><em>set</em>) – List-like array of indices within the subimage.</p></li>
<li><p><strong>idxlistdims</strong> (<em>tuple</em>) – (nrows, ncols) of the subimage.</p></li>
<li><p><strong>row_offset</strong> (<em>int</em>) – The row in the parent image corresponding to the lowest row in the
subimage.</p></li>
<li><p><strong>col_offset</strong> (<em>int</em>) – The column in the parent image corresponding to the left-most column
in the subimage.</p></li>
<li><p><strong>globaldims</strong> (<em>tuple</em>) – (nrows, ncols) of the parent image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idcsflat</strong> – The indices in indexlist in terms of the parent image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.remove_blobs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">remove_blobs</code><span class="sig-paren">(</span><em>I</em>, <em>blobthresh</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#remove_blobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.remove_blobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove blobs of a binary image that are smaller than blobthresh. A blob is
simply a set of connected “on” pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to remove blobs from.</p></li>
<li><p><strong>blobthresh</strong> (<em>int</em>) – Minimum number of pixels a blob must contain for it to be kept.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong> – Binary image with blobs filetered. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_branchpoints">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_branchpoints</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_branchpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_branchpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the branchpoints in a skeletonized image. Branchpoints are not simply
those with more than two neighbors; they are identified in a way that
minimizes the number of branchpoints required to resolve the skeleton
fully with the fewest number of branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.array</em>) – Skeletonized image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ibps</strong> – Binary image of shape Iskel where only branchpoints are on.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_endpoints">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_endpoints</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_endpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_endpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the endpoints of a skeleton.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.array</em>) – Binary skeleton image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eps</strong> – Skeleton endpoint positions in (row, col) format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_kernels">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_kernels</code><span class="sig-paren">(</span><em>caseno</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_kernels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides kernels for convolving with skeleton image to remove the following case:</p>
<p>0 0 0
1 1 1
0 1 0</p>
<p>and its rotations. The center pixel would be removed as doing so
does not break connectivity of the skeleton.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>caseno</strong> (<em>int</em>) – Identifier for specific kernel cases. Can be 1-4.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kernel</strong> – 3x3 kernel corresponding to the caseno.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_pixel_curvature">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_pixel_curvature</code><span class="sig-paren">(</span><em>Iskel</em>, <em>nwalk=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_pixel_curvature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_pixel_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides an estimate of the curvature at most pixels within a skeleton image.
Not all pixels are considered; some boundary pixels (i.e. those
near the end of the skeleton) will not be computed. The more pruned and
thinned the input skeleton, the less likely that any strange values will
be returned. This code was written so that strange cases are merely
skipped.</p>
<p>Given an input skeleton image, the code looks at each pixel and fits a
trendline through npix pixels “upstream” and “downstream” of the pixel in
question. Scale is therefore set by npixels; larger will reduce
variability in the curvature estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Iskel</strong> (<em>np.array</em>) – Binary skeleton image to compute curvatures.</p></li>
<li><p><strong>nwalk</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of pixels to walk away, in each direction, to define the
curve to compute a pixel’s curvature. Higher results in smoother
curvature values. The default is 4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I</strong> – Image wherein pixel values represent the curvature of the skeleton.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.trim_idcs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">trim_idcs</code><span class="sig-paren">(</span><em>imshape</em>, <em>idcs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#trim_idcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.trim_idcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Trims a list of indices by removing the indices that cannot fit within a
raster of imshape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imshape</strong> (<em>tuple</em>) – Shape of image to filter idcs against.</p></li>
<li><p><strong>idcs</strong> (<em>np.array</em>) – Indices to ensure fit within an image of shape imshape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idcs</strong> – Indices that can fit within imshape.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.io_utils"></span><div class="section" id="input-output-utilities-io-utils-py">
<h2>Input/Output Utilities (io_utils.py)<a class="headerlink" href="#input-output-utilities-io-utils-py" title="Permalink to this headline">¶</a></h2>
<p>Functions for input/output.</p>
<p>Created on Sun Sep 16 15:15:18 2018</p>
<p>&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.io_utils.centerline_to_geovector">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">centerline_to_geovector</code><span class="sig-paren">(</span><em>cl</em>, <em>crs</em>, <em>path_export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#centerline_to_geovector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.centerline_to_geovector" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports centerline coordinates as a georeferenced linestring. Can be used
with any set of coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cl</strong> (<em>np.array</em>) – ((xs), (ys)) array of coordinates to write. The coordinates should already be
in terms of the provided crs.</p></li>
<li><p><strong>crs</strong> (<em>pyproj.CRS</em>) – CRS object specifying the coordinate reference system of the provided
coordinates</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path, including extension, specifying where to save the coordinates export.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.colortable">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">colortable</code><span class="sig-paren">(</span><em>ctype</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#colortable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.colortable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a gdal-ingestible color table for a set of pre-defined options.
Can add your own colortable options. See <a class="reference external" href="https://gdal.org/doxygen/structGDALColorEntry.html">https://gdal.org/doxygen/structGDALColorEntry.html</a>
and <a class="reference external" href="https://gis.stackexchange.com/questions/158195/python-gdal-create-geotiff-from-array-with-colormapping">https://gis.stackexchange.com/questions/158195/python-gdal-create-geotiff-from-array-with-colormapping</a>
for guidance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ctype</strong> (<em>str</em>) – Specifies the type of colortable to return. Choose from
{‘binary’, ‘skel’, ‘mask’, ‘tile’, or ‘GSW’}.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>color_table</strong> – Color table that can be supplied to gdal when creating a raster.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gdal.ColorTable()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.coords_from_geovector">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">coords_from_geovector</code><span class="sig-paren">(</span><em>path_geovector</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#coords_from_geovector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.coords_from_geovector" title="Permalink to this definition">¶</a></dt>
<dd><p>Retreives coordinates from a shapefile containing a LineString or Points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path_geovector</strong> (<em>str</em>) – Path, including .shp extension, of the file containing coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Coordinates (x, y) of the vertices in the provided geovector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.coords_to_geovector">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">coords_to_geovector</code><span class="sig-paren">(</span><em>coords</em>, <em>epsg</em>, <em>path_export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#coords_to_geovector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.coords_to_geovector" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports coordinates to a Point shapefile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>list-like of list-likes</em>) – List or tuple of (x, y) coordinates to export.</p></li>
<li><p><strong>epsg</strong> (<em>int</em>) – EPSG code of the coordinate reference system of the coordinates.</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path with .shp extension where the shapefile should be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.create_manual_dir_csv">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">create_manual_dir_csv</code><span class="sig-paren">(</span><em>path_csv</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#create_manual_dir_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.create_manual_dir_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a .csv file for fixing links manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path_csv</strong> (<em>str</em>) – Path, including .csv extension, where the .csv is written.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.get_driver">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">get_driver</code><span class="sig-paren">(</span><em>path_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#get_driver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.get_driver" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the proper geopandas driver for saving a geodataframe. Keys off the
extension in the filename, and supports either shapefiles or geojsons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path_file</strong> (<em>str</em>) – Where the file will be saved.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>driver</strong> – Driver string specifying file format when using geopandas’ to_file().</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.links_to_geofile">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">links_to_geofile</code><span class="sig-paren">(</span><em>links</em>, <em>dims</em>, <em>gt</em>, <em>crs</em>, <em>path_export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#links_to_geofile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.links_to_geofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the links of the network to a georeferencedshapefile or geojson.
Computed link properties are saved as attributes when available. Note that
the ‘wid_pix’ property, which stores the width at each pixel along the
link, may be truncated depending on its length and the filetype.
The filetype is specified by the export path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – (nrows, ncols) of the original mask from which links were derived.</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – GDAL geotransform of the original mask from which links were derived.</p></li>
<li><p><strong>crs</strong> (<em>pyrpoj.CRS</em>) – CRS object specifying the coordinate reference system of the original
mask from which links were derived.</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path, including extension, specifying where to save the links export.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.nodes_to_geofile">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">nodes_to_geofile</code><span class="sig-paren">(</span><em>nodes</em>, <em>dims</em>, <em>gt</em>, <em>crs</em>, <em>path_export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#nodes_to_geofile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.nodes_to_geofile" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the nodes of the network to a georeferencedshapefile or geojson.
Computed node properties are appended as attributes when available.
The filetype is specified by the export path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – (nrows, ncols) of the original mask from which nodes were derived.</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – GDAL geotransform of the original mask from which nodes were derived.</p></li>
<li><p><strong>crs</strong> (<em>pyrpoj.CRS</em>) – CRS object specifying the coordinate reference system of the original
mask from which nodes were derived.</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path, including extension, where to save the nodes export.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.pickle_links_and_nodes">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">pickle_links_and_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>path_out</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#pickle_links_and_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.pickle_links_and_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the links and nodes dictionaries to a pickle file for easy loading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>path_out</strong> (<em>str</em>) – Where to save the pickle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.prepare_paths">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">prepare_paths</code><span class="sig-paren">(</span><em>path_results</em>, <em>name</em>, <em>path_mask</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#prepare_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.prepare_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dictionary of paths for most of the RivGraph-exportable files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_results</strong> (<em>str</em>) – The directory of the path where results are exported. Will be created
if it does not exist.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name of the analysis that is prepended to exported results.</p></li>
<li><p><strong>path_mask</strong> (<em>str</em>) – Path to the mask geotiff, including extension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>paths</strong> – Contains all the export paths. Not all will be necessarily used, but
all possible exports’ paths are contained.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.shapely_list_to_geovectors">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">shapely_list_to_geovectors</code><span class="sig-paren">(</span><em>shplist</em>, <em>crs</em>, <em>path_export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#shapely_list_to_geovectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.shapely_list_to_geovectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports a list of shapely geometries to a GIS-ingestible format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shplist</strong> (<em>list</em>) – A list of shapely.geometry objects defining components of the mesh.</p></li>
<li><p><strong>crs</strong> (<em>pyproj.CRS</em>) – CRS object specifying the coordinate reference system of the geometries
to export.</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path, including extension, where the geovector data should be written.
Extensions can be either ‘.shp’ or ‘.geojson’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.unpickle_links_and_nodes">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">unpickle_links_and_nodes</code><span class="sig-paren">(</span><em>path_pickle</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#unpickle_links_and_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.unpickle_links_and_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpickles a previously pickled network. Note that ordered_set is reloaded
within this function so that pickle can interpret OrderedSet object fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path_pickle</strong> (<em>str</em>) – Path to the pickled network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.write_geotiff">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">write_geotiff</code><span class="sig-paren">(</span><em>raster, gt, wkt, path_export, dtype='GDT_UInt16', options=['COMPRESS=LZW'], nbands=1, nodata=None, color_table=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#write_geotiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.write_geotiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a georeferenced raster to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> (<em>np.array</em>) – Image to be written. Shape is (nrows, ncols, nbands), although if only
one band is present the shape can be just (nrows, ncols).</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – GDAL geotransform for the raster. Often this can simply be copied from
another geotiff via gdal.Open(path_to_geotiff).GetGeoTransform(). Can
also be constructed following the gdal convention of
(leftmost coordinate, pixel width, xskew, uppermost coordinate, pixel height, yskew).
For non-rotated images, the skews will be zero.</p></li>
<li><p><strong>wkt</strong> (<em>str</em>) – Well-known text describing the coordinate reference system of the raster.
Can be copied from another geotiff with gdal.Open(path_to_geotiff).GetProjection().</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path with extension of the geotiff to export.</p></li>
<li><p><strong>dtype</strong> (<em>gdal.GDT_XXX</em><em>, </em><em>optional</em>) – Gdal data type. Options for XXX include Byte, UInt16, UInt32, Int32,
Float32, Float64 and complex types CInt16, Cint32, CFloat32 and CFloat64.
If storing decimal data, use a Float type, binary data use Byte type.
The default is gdal.GDT_UInt16 (non-float).</p></li>
<li><p><strong>options</strong> (<em>list of strings</em><em>, </em><em>optional</em>) – Options that can be fed to gdal dataset creator. See YYY for what
can be specified by options.
The default is [‘COMPRESS=LZW’].</p></li>
<li><p><strong>nbands</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bands of the raster. The default is 1.</p></li>
<li><p><strong>nodata</strong> (<em>numeric</em><em>, </em><em>optional</em>) – Pixels with this value will be written as nodata. If None, no nodata
value will be considered. The default is None.</p></li>
<li><p><strong>color_table</strong> (<em>gdal.ColorTable</em><em>, </em><em>optional</em>) – Color table to append to the geotiff. Can use colortable() function
to create, or create a custom type with gdal.ColorTable().
Note that color_tables can only be specified for Byte and UInt16 datatypes.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.write_linkdirs_geotiff">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">write_linkdirs_geotiff</code><span class="sig-paren">(</span><em>links</em>, <em>gdobj</em>, <em>path_export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#write_linkdirs_geotiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.write_linkdirs_geotiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a geotiff where links are colored according to their directionality.
Pixels in each link are interpolated between 0 and 1 such that the upstream
pixel is 0 and the downstream-most pixel is 1. In a GIS, color can then
be set to visualize flow directionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>gdobj</strong> (<em>osgeo.gdal.Dataset</em>) – GDAL object correspondng to the original mask from which links were
derived.</p></li>
<li><p><strong>path_export</strong> (<em>str</em>) – Path, including .tif extension, where the directions geotiff is
written.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.ln_utils"></span><div class="section" id="network-utilities-ln-utils-py">
<h2>Network Utilities (ln_utils.py)<a class="headerlink" href="#network-utilities-ln-utils-py" title="Permalink to this headline">¶</a></h2>
<p>Created on Mon Sep 10 09:59:52 2018</p>
<p>&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.ln_utils.add_artificial_nodes">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">add_artificial_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#add_artificial_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.add_artificial_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add artificial nodes.</p>
<p>Some topologic metrics fail for graphs that contain parallel links, or
links that share the same end nodes. This function alleviates that issue
by inserting artificial nodes into all but one of the parallel links. The
shortest link of the parallel set will not receive an artificial node.
For simplicity of coding, when a node is added, the old link is deleted and
two new links are put in its place.</p>
<p>A new attribute is appended to the nodes dictionary called ‘arts’ that
contains the node IDs of artifical nodes.</p>
<p>If flow directions are needed, this function should be run after setting
them. If flow directions have been set for links, the properties of the
link that is broken into two are appended to the two parts. This may result
in some properties that are no longer correct, e.g. slope.</p>
<p>Additionally, the ‘guess’ attribute of the links where artificial nodes
are added will be incorrect as it doesn’t account for the artificial node,
but references the original end nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>gdobj</strong> (<em>osgeo.gdal.Dataset</em>) – GDAL dataset of the original mask, created via gdal.Open().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with aritifical nodes added.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with artificial nodes added as a new ‘arts’ attribute.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.add_link">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">add_link</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>idcs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#add_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.add_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new link to the network.</p>
<p>Adds a new link to the network. Connectivity is updated in nodes to account
for the added link. Attributes such as link width, length are not
recomputed here; must be recomputed for the entire network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>idcs</strong> (<em>list</em>) – Pixel indices comprising the link.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – Raised if the added link isn’t connected to existing nodes at both ends.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with the link added.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with the link added.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.add_node">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">add_node</code><span class="sig-paren">(</span><em>nodes</em>, <em>idx</em>, <em>linkconn</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#add_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.add_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new node to the network.</p>
<p>Adds a new node to the network. Connectivity is updated in links to account
for the added node. No node properties (e.g. juncation angle) are updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – Pixel index within the original mask of the node to add.</p></li>
<li><p><strong>linkconn</strong> (<em>list</em><em> or </em><em>int</em>) – ID(s) of the link that the node is connected to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nodes</strong> – Network nodes with the node added.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.adjust_for_padding">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">adjust_for_padding</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>npad</em>, <em>dims</em>, <em>initial_dims</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#adjust_for_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.adjust_for_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust mask for any padding.</p>
<p>In some cases, a mask is padded before extracting the network. In order
to ensure the extracted network maps to the original mask, the padding must
be stripped away from all the coordinates of the network. The function
achieves this by adjusting the [‘idx’] attributes of the links and nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>npad</strong> (<em>int</em>) – Pad width to remove. Assumes padding was performed on all four edges
of image.</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – (nrows, ncols) of the padded image.</p></li>
<li><p><strong>initial_dims</strong> (<em>tuple</em>) – (nrows, ncols) of the original (unpadded) image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links adjusted to remove padding.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes adjusted to remove padding.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.append_link_lengths">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">append_link_lengths</code><span class="sig-paren">(</span><em>links</em>, <em>gdobj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#append_link_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.append_link_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Append link lengths to each link.</p>
<p>Appends link lengths to each link. Lengths are computed in the units of
the coordinate reference system of the original mask.</p>
<p>This function provides a subset of the functionality of
<a class="reference internal" href="#rivgraph.ln_utils.link_widths_and_lengths" title="rivgraph.ln_utils.link_widths_and_lengths"><code class="xref py py-func docutils literal notranslate"><span class="pre">link_widths_and_lengths()</span></code></a>.
It is used when only link lengths are needed for, e.g. finding shortest
paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>gdobj</strong> (<em>osgeo.gdal.Dataset</em>) – GDAL dataset of the original mask, created via gdal.Open().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network links with length attribute appended.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.conn_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">conn_links</code><span class="sig-paren">(</span><em>nodes</em>, <em>links</em>, <em>node_idx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#conn_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.conn_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Find first and last pixels of all links connected to a node.</p>
<p>Finds the first and last pixels of all links connected to the node specified
by node_idx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>node_idx</strong> (<em>int</em>) – Index of the node (not its id) to query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>link_pix</strong> – A list of [first pixel, last pixel] for each link connected to the
node specified by node_idx.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.delete_link">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">delete_link</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>linkid</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#delete_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.delete_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a link from the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>linkid</strong> (<em>int</em>) – ID of link (as found in links[‘id’]) to delete.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with link updated.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with node updated.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.delete_node">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">delete_node</code><span class="sig-paren">(</span><em>nodes</em>, <em>nodeid</em>, <em>warn=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#delete_node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.delete_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a node from the network.</p>
<p>Deletes a node from the network. Assumes that the node’s connected links
have already been deleted, and hence does not update the links dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>nodeid</strong> (<em>int</em>) – ID of the node (as found in nodes[‘id’]) to delete.</p></li>
<li><p><strong>warn</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will print a warning if a node is being deleted that is still
connected to links in the network. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nodes</strong> – Network nodes with the node deleted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.find_art_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">find_art_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#find_art_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.find_art_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Find artificial links.</p>
<p>Finds the triad links corresponding to each artificial node. The triad
links are the two links connected to the artifical node, and the link
parallel to these two links.</p>
<p>Adds a new ‘arts’ property to the links dictionary that contains the triad
set for each artificial node in nodes[‘arts’].</p>
<p>This function has little use after changing how RivGraph considers
parallel links.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network link with ‘arts’ attribute.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.find_parallel_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">find_parallel_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#find_parallel_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.find_parallel_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Find parallel links within the graph.</p>
<p>Finds all parallel links within the graph. A set of parallel links all have
the same start and end node. A new attribute called ‘parallels’ is added
to the links dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with parallel attribute appended.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.flip_link">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">flip_link</code><span class="sig-paren">(</span><em>links</em>, <em>linkid</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#flip_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.flip_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse a link’s direction.</p>
<p>Reverses a link’s direction by flipping the ordering of its comprising
pixels, as well as any ordered attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>linkid</strong> (<em>int</em>) – ID of the link to flip (within links[‘id’]).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network links with the link flipped.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.junction_angles">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">junction_angles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>imshape</em>, <em>pixlen</em>, <em>weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#junction_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.junction_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute junction angles.</p>
<p>Computes junction angles between links in a network with directions set.
Only nodes of degree three are considered for simplicity. Angles are only
computed between the two links that share a common flow directions. The
acute-most angle between these two links is returned.</p>
<p>The direction of an individual link is poorly constrained. The number of
pixels along the link to consider for computing its direction can result
in vastly different directions depending on the link’s morphology. The
weight argument above allows a degree of control over how to weight the
contribution of pixels to a link’s direction vector.</p>
<p>Also computes the ratio of link widths (max/min) at junctions, and
determines whether the junction is a confluence (joining) or a bifurcation
(diverging).</p>
<p>The following attributes are appended to the nodes dictionary:</p>
<ul class="simple">
<li><p><strong>int_ang</strong> : the interior angle between the two links in the</p></li>
<li><p><strong>width_ratio</strong> : the ratio of the maximum/minimum link widths for the two links whose directions agree</p></li>
<li><p><strong>jtype</strong> : the junction type, either ‘b’ifurcation or ‘c’onfluence</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>imshape</strong> (<em>tuple</em>) – (nrows, ncols) of the original mask.</p></li>
<li><p><strong>pixlen</strong> (<em>numeric</em>) – Resolution of the image; assumes same resolution in the horizontal and
vertical.</p></li>
<li><p><strong>weight</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>How to weight pixel contributions to a link’s direction vector as we
move away from the joining node. Choose from</p>
<ul>
<li><p><strong>None</strong> : all pixels are weighted equally</p></li>
<li><p><strong>lin</strong> : the contribution of pixels decreases linearly as we move away from the joining node.</p></li>
<li><p><strong>exp</strong> : the contribution of  pixels decreases exponentially as we move away from the joining node.</p></li>
</ul>
<p>The default is None.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – Ensures that flow directions have been computed before running this
    function.</p></li>
<li><p><strong>RuntimeError</strong> – Catches any strange cases where a junction is neither a bifurcation
    nor junction. Have not encountered this yet, please report if triggered.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>nodes</strong> – Network nodes and associated properties.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.link_updater">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">link_updater</code><span class="sig-paren">(</span><em>links</em>, <em>linkid</em>, <em>idx=-1</em>, <em>conn=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#link_updater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.link_updater" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the link dictionary.</p>
<p>Updates link dictionary by appending a new link or adding connectivity
to an existing link. This function cannot add a new link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties. Should contain ‘id’, ‘idx’,
and ‘conn’ at a minimum.</p></li>
<li><p><strong>linkid</strong> (<em>int</em>) – ID of the link to update.</p></li>
<li><p><strong>idx</strong> (<em>list</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – Pixel indices of the link to update. The default is -1, which
effectively skips updating the idx field.</p></li>
<li><p><strong>conn</strong> (<em>int</em><em>, </em><em>optional</em>) – Node id (as found in nodes[‘id’]) connected to the link. The default
is -1, which effectively skips updating the ‘id’ field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network links with link updated.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.link_widths_and_lengths">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">link_widths_and_lengths</code><span class="sig-paren">(</span><em>links</em>, <em>Idt</em>, <em>pixlen=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#link_widths_and_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.link_widths_and_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all link widths and lengths.</p>
<p>Computes link widths and lengths for all links in the network. A
distance transform approach is used where the width of a pixel is its
distance to the nearest non-max pixel times two.</p>
<p>There is a slight twist. When a skeleton is computed for a very wide
channel with a narrow tributary, there is a very straight section of the
skeleton as it leaves the wide channel to go into the tributary; this
straight section (so-called “false” pixels) should not be used to compute
average link width, as it’s technically part of the wide channel. The twist
here accounts for that by elminating the ends of the each link from
computing widths and lengths, where the distance along each end is equal to
the half-width of the endmost pixels. Adjusted link widths and lengths are
also computed that account for this effect.</p>
<p>The following new attributes are added to the links dictionary:</p>
<ul class="simple">
<li><p>‘len’ : the length of the full link</p></li>
<li><p>‘wid_pix’ : the width of each pixel in the link</p></li>
<li><p>‘wid’ : the average width of all pixels of the link</p></li>
<li><p>‘wid_adj’ : the “adjusted” average width of all link pixels excluding “false” pixels</p></li>
<li><p>‘len_adj’ : the “adjusted” length of the link after excluding “false” pixels</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>Idt</strong> (<em>np.array</em>) – Distance transform of the original mask.</p></li>
<li><p><strong>pixlen</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – Length (or resolution) of the pixel. If provided, assumes that the
pixel resolution is the same in the horizontal and vertical directions.
The default is 1, which corresponds to computing widths and lengths
in units of pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network links with width and length properties appended.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.links_to_gpd">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">links_to_gpd</code><span class="sig-paren">(</span><em>links</em>, <em>gdobj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#links_to_gpd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.links_to_gpd" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the links dictionary to a GeoPandas GeoDataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>gdobj</strong> (<em>osgeo.gdal.Dataset</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links_gpd</strong> – GDAL dataset of the original mask, created via gdal.Open().</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.node_updater">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">node_updater</code><span class="sig-paren">(</span><em>nodes</em>, <em>idx</em>, <em>conn</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#node_updater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.node_updater" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the node dictionary.</p>
<p>Updates node dictionary by adding connectivity and idx information
to an existing node. The function cannot add a node to the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties Should contain ‘id’, ‘idx’,
and ‘conn’ keys at a minimum.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – The index of the node, as found in nodes[‘idx’].</p></li>
<li><p><strong>conn</strong> (<em>int</em>) – Link id (as found in links[‘id’]) connected to the node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nodes</strong> – Network nodes with node updated.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.plot_dirlinks">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">plot_dirlinks</code><span class="sig-paren">(</span><em>links</em>, <em>dims</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#plot_dirlinks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.plot_dirlinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the network links with flow direction denoted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with flow directions set.</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – (nrows, ncols) of original mask that links were derived from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.plot_network">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">plot_network</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>Imask</em>, <em>name=None</em>, <em>label_links=True</em>, <em>label_nodes=True</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#plot_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.plot_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the network with labeled link and node IDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>Imask</strong> (<em>np.array</em>) – The original binary mask.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the channel network for labeling the plot.</p></li>
<li><p><strong>label_links</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will label all links with their ids.</p></li>
<li><p><strong>label_nodes</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, will label all nodes with their ids.</p></li>
<li><p><strong>axis</strong> (<em>matplotlib.axex._subplots.AxesSubplot</em><em>, </em><em>optional</em>) – If provided, plotting will occur within the provided axis. Can be created
with matplotlib.pyplot.subplots(). The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_all_spurs">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_all_spurs</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>dontremove=[]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_all_spurs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_all_spurs" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove spurs.</p>
<p>Removes all links who have a node of degree one. This is performed iteratively
until all spurs are removed. Also removes redundant nodes (i.e. nodes
with degree two.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network link and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>dontremove</strong> (<em>list</em><em>, </em><em>optional</em>) – Node IDs not to remove (e.g. inlet and/or outlet nodes).
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with spurs removed.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with spurs removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_disconnected_bridge_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_disconnected_bridge_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_disconnected_bridge_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_disconnected_bridge_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove disconnected bridge links.</p>
<p>When simplifying a channel network, there are often tributaries joining
the network further downstream. These tributaries may have loops, which
prevents their automatic removal by simple pruning.</p>
<p>This function helps prune these cases by removing bridge links that are
not integral to the network. A bridge link is one whose removal results
in an increase in the number of connected components in the network. Each
bridge link is temporarily removed from the network. This leaves two
end nodes which were connected by the bridge link. A bridge link is
integral if a path can be found from the end nodes to inlets and
outlets (if one end node is connected to an inlet(s), the other must
be connected to an outlet(s)).</p>
<p>After all non-integral bridge links are removed, the connected component
network that contains the inlet and outlets is returned; all other
subnetworks are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Pruned network links.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Pruned network nodes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_duplicate_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_duplicate_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_duplicate_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_duplicate_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Eliminates any duplicate links in the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with duplicate links removed.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with duplicate nodes removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_single_pixel_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_single_pixel_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_single_pixel_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_single_pixel_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove single pixel links.</p>
<p>RivGraph’s resolving of the network can result in single-pixel links that
can be removed without altering connectivity. This function removes those.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with single pixel links removed.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with single pixel links removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_two_link_nodes">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_two_link_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>dontremove</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_two_link_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_two_link_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove superfluous nodes.</p>
<p>Removes superfluous nodes from the network; i.e. nodes with degree two.
Is called by <a class="reference internal" href="#rivgraph.ln_utils.remove_all_spurs" title="rivgraph.ln_utils.remove_all_spurs"><code class="xref py py-func docutils literal notranslate"><span class="pre">remove_all_spurs()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>dontremove</strong> (<em>list</em>) – Node IDs that should not be removed (e.g. inlets or outlets).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with superfluous nodes removed.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes with superfluous nodes removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.mask_to_graph"></span><div class="section" id="mask-to-graph-utilities-mask-to-graph-py">
<h2>Mask to Graph Utilities (mask_to_graph.py)<a class="headerlink" href="#mask-to-graph-utilities-mask-to-graph-py" title="Permalink to this headline">¶</a></h2>
<p>Functions for converting a binary channel mask to a graphical representation.</p>
<dl class="function">
<dt id="rivgraph.mask_to_graph.pad_river_im">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">pad_river_im</code><span class="sig-paren">(</span><em>I</em>, <em>es</em>, <em>pm=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#pad_river_im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.pad_river_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Pads the edges of a binary river image by extending the ends of the river.
Different than mirrored padding in that the “mirror” here is just a
rectangle. This simplifies skeletonization and interpretation in cases
where the channel is complex near the boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to pad; typically a river channel network.</p></li>
<li><p><strong>es</strong> (<em>str</em>) – A two-character string (from N, E, S, or W) that denotes which sides
of the image the river intersects (upstream first) – e.g. ‘NS’, ‘EW’,
‘NW’, etc.</p></li>
<li><p><strong>pm</strong> (<em>int</em><em>, </em><em>optional</em>) – Pad multiplier that sets the size of the padding. Multplies the blob
size along the axis of the image that the blob intersect to determine
the padding distance. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Ip</strong> (<em>np.array</em>) – The padded image..</p></li>
<li><p><strong>pads</strong> (<em>list</em>) – 4 entry list containing the number of pixels padded on the [n, s, e, w]
edges of the image.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.simplify_skel">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">simplify_skel</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#simplify_skel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.simplify_skel" title="Permalink to this definition">¶</a></dt>
<dd><p>This function iterates through all skeleton pixels pixels that have
connectivity &gt; 2. It removes the pixel and checks if the
number of blobs has changed after removal. If so, the pixel is necessary to
maintain connectivity. Otherwise the pixel is not retained. It also adds
pixels to the centers of “+” cases, as this reduces the number
of branchpoints from 4 to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.array</em>) – Image of the skeleton to simplify.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iskel</strong> – The simplified skeleton.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.skel_to_graph">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">skel_to_graph</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#skel_to_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.skel_to_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves a skeleton into its consitutent links and nodes.
This function finds a starting point to walk along a skeleton, then begins
the walk. Rules are in place to ensure the network is fully resolved. One
of the key algorithms called by this function involves the identfication of
branchpoints in a way that eliminates unnecessary ones to create a parsimonious
network. Rules are baked in for how to walk along the skeleton in cases
where multiple branchpoints are clustered or there are multiple possible
links to walk along.</p>
<p>Note that some minor adjustments to the skeleton may be made in order to
reduce the complexity of the network. For example, in the case of a “+”
with a missing center pixel in the skeleton, this function will add the
pixel to the center to enable the use of a single branchpoint as opposed to
four.</p>
<p>The takeaway is that there is no guarantee that the input skeleton will
be perfectly preserved when network-ifying. One possible workaround, if
perfect preservation is required, is to resample the skeleton to double the
resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Binary image of a skeleton.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Links of the network with four properties:</p>
<ol class="arabic simple">
<li><p>’id’ - a list of unique ids for each link in the network</p></li>
<li><p>’idx’ - a list containing the pixel indices within Iskel that defines the link. These are ordered.</p></li>
<li><p>’conn’ - a list of 2-element lists containing the node ids that the link is connected to.</p></li>
<li><p>’n_networks’ - the number of disconnected networks found in the skeleton</p></li>
</ol>
</li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Nodes of the network with four properties:</p>
<ol class="arabic simple">
<li><p>’id’ - a list of unique ids for each node in the network</p></li>
<li><p>’idx’ - the index within Iskel of the node location</p></li>
<li><p>’conn’ - a list of lists containing the link ids connected to this node</p></li>
</ol>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.skeletonize_mask">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">skeletonize_mask</code><span class="sig-paren">(</span><em>Imask</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#skeletonize_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.skeletonize_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes an input binary image, typically a mask. Also performs some
skeleton simplification by (1) removing pixels that don’t alter connectivity,
and (2) filling small skeleton holes and reskeletonizing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Imask</strong> (<em>np.array</em>) – Binary image to be skeletonized.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iskel</strong> – The skeletonization of Imask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.skeletonize_river_mask">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">skeletonize_river_mask</code><span class="sig-paren">(</span><em>I</em>, <em>es</em>, <em>padscale=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#skeletonize_river_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.skeletonize_river_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes a binary mask of a river channel network. Differs from
skeletonize mask above by using knowledge of the exit sides of the river
with respect to the mask (I) to avoid edge effects of skeletonization by
mirroring the mask at its ends, then trimming it after processing. As with
skeletonize_mask, skeleton simplification is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary river mask to skeletonize.</p></li>
<li><p><strong>es</strong> (<em>str</em>) – A two-character string (from N, E, S, or W) that denotes which sides
of the image the river intersects (upstream first) – e.g. ‘NS’, ‘EW’,
‘NW’, etc.</p></li>
<li><p><strong>padscale</strong> (<em>int</em><em>, </em><em>optional</em>) – Pad multiplier that sets the size of the padding. Multplies the blob
size along the axis of the image that the blob intersect to determine
the padding distance. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iskel</strong> – The skeletonization of I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.mask_utils"></span><div class="section" id="mask-filtering-utils-mask-utils-py">
<h2>Mask Filtering Utils (mask_utils.py)<a class="headerlink" href="#mask-filtering-utils-mask-utils-py" title="Permalink to this headline">¶</a></h2>
<p>Functions for filtering islands from channel masks. Currently in beta.
Also see <code class="xref py py-mod docutils literal notranslate"><span class="pre">im_utils</span></code> for morphologic operations that could be useful.</p>
<p>Created on Mon Jul 6 18:29:23 2020</p>
<p>&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.mask_utils.get_island_properties">
<code class="descclassname">rivgraph.mask_utils.</code><code class="descname">get_island_properties</code><span class="sig-paren">(</span><em>Imask</em>, <em>pixlen</em>, <em>pixarea</em>, <em>crs</em>, <em>gt</em>, <em>props</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_utils.html#get_island_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_utils.get_island_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Get island properties.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_utils.pixagon">
<code class="descclassname">rivgraph.mask_utils.</code><code class="descname">pixagon</code><span class="sig-paren">(</span><em>c_cent</em>, <em>r_cent</em>, <em>pixlen</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_utils.html#pixagon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_utils.pixagon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a shapely polygon
of a provided center coordinate given the pixel resolution (pixlen).</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_utils.surrounding_link_properties">
<code class="descclassname">rivgraph.mask_utils.</code><code class="descname">surrounding_link_properties</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>Imask</em>, <em>islands</em>, <em>Iislands</em>, <em>pixlen</em>, <em>pixarea</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_utils.html#surrounding_link_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_utils.surrounding_link_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the links surrounding each island and computes their properties. This
function is useful for filtering; e.g. when it is desired to remove islands
surrounded by very large channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes.</p></li>
<li><p><strong>Imask</strong> (<em>np.array</em>) – Binary mask of the channel network.</p></li>
<li><p><strong>islands</strong> (<em>geopandas.GeoDataframe</em>) – Contains island boundaries and associated properties. Created by
get_island_properties().</p></li>
<li><p><strong>Iislands</strong> (<em>np.array</em>) – Image wherein each island has a unique integer ID.</p></li>
<li><p><strong>pixlen</strong> (<em>numeric</em>) – Nominal length of a pixel (i.e. its resolution).</p></li>
<li><p><strong>pixarea</strong> (<em>numeric</em>) – Nominal area of a pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>islands</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geopandas.GeoDataframe</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.walk"></span><div class="section" id="skeleton-walking-utils-walk-py">
<h2>Skeleton Walking Utils (walk.py)<a class="headerlink" href="#skeleton-walking-utils-walk-py" title="Permalink to this headline">¶</a></h2>
<p>Functions for walking along skeletons and finding branchpoints.</p>
<p>Created on Mon Sep 10 09:39:19 2018</p>
<dl class="function">
<dt id="rivgraph.walk.bp_cluster">
<code class="descclassname">rivgraph.walk.</code><code class="descname">bp_cluster</code><span class="sig-paren">(</span><em>bp</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#bp_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.bp_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Find clusters of branchpoints.</p>
<p>Finds clusters of branchpoints; i.e. branchpoints that are immediately
adjacent to each other in an 8-connected sense. This function is self-
referential in order to find all neighboring branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bp</strong> (<em>list</em>) – Contains the branchpoint cluster as indices (np.ravel_multi_index)
within Iskel. In the initial call, this list contains only a single
branchpoint.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bp</strong> – Contains the branchpoint cluster as indices (np.ravel_multi_index)
within Iskel.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.cant_walk">
<code class="descclassname">rivgraph.walk.</code><code class="descname">cant_walk</code><span class="sig-paren">(</span><em>links</em>, <em>linkidx</em>, <em>nodes</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#cant_walk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.cant_walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Find pixels that cannot be walked to.</p>
<p>Given an input link defined by linkidx, return all the pixels that cannot
be walked to. These include:</p>
<ol class="arabic simple">
<li><p>originating node (and any nodes adjacent to this one)</p></li>
<li><p>emanating links (i.e. first pixel away from each node)</p></li>
<li><p>links that have been resolved walking AWAY from the node (toward node not included)</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>linkidx</strong> (<em>int</em>) – Index of the link id within links[‘id’] of the link to analyze.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>walked</strong> – Indices of pixels within Iskel that have already been walked to.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.check_dup_links">
<code class="descclassname">rivgraph.walk.</code><code class="descname">check_dup_links</code><span class="sig-paren">(</span><em>linkid</em>, <em>links</em>, <em>nodes</em>, <em>links2do</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#check_dup_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.check_dup_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for duplicate links.</p>
<p>Checks that the link represented by linkid has no dubplicates in the
network. If so, the link is removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linkid</strong> (<em>int</em>) – Id of the link to check for duplication.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>links2do</strong> (<em>OrderedSet</em>) – This set keeps track of all the links that still need to be resolved
in the full skeleton. It is generated and populated in
<code class="xref py py-mod docutils literal notranslate"><span class="pre">mask_to_graph</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with duplicate link removed, if
it existed.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with duplicate ilnk removed, if
it existed.</p></li>
<li><p><strong>links2do</strong> (<em>OrderedSet</em>) – This set keeps track of all the links that still need to be resolved
in the full skeleton. It is generated and populated in
<code class="xref py py-mod docutils literal notranslate"><span class="pre">mask_to_graph</span></code>.
The duplicate link, if found, is removed from this set.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.delete_link">
<code class="descclassname">rivgraph.walk.</code><code class="descname">delete_link</code><span class="sig-paren">(</span><em>linkid</em>, <em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#delete_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.delete_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a link from the links dictionary and update the nodes dictionary.</p>
<p>Deletes a link from the links dictionary and updates the nodes dictionary
to account for the deleted link. This is a special case of the delete_link
found in ln_utils.py, as no properties have been added yet. It is possible
that this function could be replaced by that one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linkid</strong> (<em>int</em>) – Id of the link to delete.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with the link deleted.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with the link deleted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.find_emanators">
<code class="descclassname">rivgraph.walk.</code><code class="descname">find_emanators</code><span class="sig-paren">(</span><em>bpnode</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#find_emanators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.find_emanators" title="Permalink to this definition">¶</a></dt>
<dd><p>Find possible next steps along the skeleton.</p>
<p>Returns all possible next steps along the skeleton from a given pixel.
Emanators are the second nodes in each link, or the first nodes away from
the link endpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bpnode</strong> (<em>np.int</em>) – Index within Iskel to look for emanators.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>all_emanators</strong> – Indices within Iskel representing emanating nodes from bpnode.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.get_neighbors">
<code class="descclassname">rivgraph.walk.</code><code class="descname">get_neighbors</code><span class="sig-paren">(</span><em>idx</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#get_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.get_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a flattened array of neighboring pixel indices.</p>
<p>Returns a flattened array of the neighboring pixel indices within Iskel
that are True. Only looks at 8-connected neighbors (i.e. a 3x3 kernel with
centered on idx).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>np.int</em>) – Index within Iskel to get neighbors.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask, but can be any image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>neighbor_idcs_gloal</strong> – Indices within Iskel of True pixels bordering idx.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.handle_bp">
<code class="descclassname">rivgraph.walk.</code><code class="descname">handle_bp</code><span class="sig-paren">(</span><em>linkid</em>, <em>bpnode</em>, <em>nodes</em>, <em>links</em>, <em>links2do</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#handle_bp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.handle_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle branchpoints.</p>
<p>When walking along a skeleton and encountering a branchpoint, we want to
initialize all un-done links emanating from the branchpoint. Each new link
contains the branchpoint as the first index, and this function also takes
the first step of the link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linkid</strong> (<em>int</em>) – Link id of the link walking from.</p></li>
<li><p><strong>bpnode</strong> (<em>np.int</em>) – Node id of the branchpoint to be resolved.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>links2do</strong> (<em>OrderedSet</em>) – This set keeps track of all the links that still need to be resolved
in the full skeleton. It is generated and populated in mask_to_graph.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the local skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>TYPE</em>) – Network links and associated properties with the branchpoint links
added.</p></li>
<li><p><strong>nodes</strong> (<em>TYPE</em>) – Network nodes and associated properties with the branchpoint-related
nodes added.</p></li>
<li><p><strong>links2do</strong> (<em>OrderedSet</em>) – Same as input, but with new link emanators added and linkid removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.idcs_no_turnaround">
<code class="descclassname">rivgraph.walk.</code><code class="descname">idcs_no_turnaround</code><span class="sig-paren">(</span><em>idcs</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#idcs_no_turnaround"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.idcs_no_turnaround" title="Permalink to this definition">¶</a></dt>
<dd><p>Find possible indices to walk to given two input indices.</p>
<p>Returns list of possible indices to walk toward given two input indices
(idcs).</p>
<p>Possible indices are defined as those which require no turning around;
e.g. if moving down, only indices further below idcs[1] will be returned.
Based on directionality, only three possible indices should be returned
for all cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idcs</strong> (<em>list</em>) – Resolved indices within Iskel of the link, in order, for which the next
step needs to be taken.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>poss_walk_idcs</strong> – Indices within Iskel of possible next steps that ensure the walk will
not move “backwards.”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.is_bp">
<code class="descclassname">rivgraph.walk.</code><code class="descname">is_bp</code><span class="sig-paren">(</span><em>idx</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#is_bp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.is_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if an index is a branchpoint.</p>
<p>Determines if the index given by idx is a branchpoint. Branchpoints are
not simply pixels in the skeleton with more than two neighbors; they are
pruned through a somewhat complicated procedure that minimizes the number
of required branchpoints to preserve the skeleton topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>np.int</em>) – Index within Iskel to determine if it is a branchpoint.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask, but can be any image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>isbp</strong> – 1 if idx is a branchpoint, else 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.isbp_parsimonious">
<code class="descclassname">rivgraph.walk.</code><code class="descname">isbp_parsimonious</code><span class="sig-paren">(</span><em>Ic</em>, <em>Icr</em>, <em>Inar</em>, <em>Infr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#isbp_parsimonious"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.isbp_parsimonious" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes parsimonious set of branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ic</strong> (<em>np.ndarray</em>) – Image of possible branchpoints; values correspond to number of
neighbors.</p></li>
<li><p><strong>Icr</strong> (<em>np.ndarray</em>) – Raveled (np.ravel) version of Ic.</p></li>
<li><p><strong>Inar</strong> (<em>np.ndarray</em>) – Raveled version of image returned by naxes_connectivity.</p></li>
<li><p><strong>Infr</strong> (<em>np.ndarray</em>) – Raveled version of image returned by nfour_connectivity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bps</strong> – All branchpoint indices within Ic.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.isbp_walk_for_bps">
<code class="descclassname">rivgraph.walk.</code><code class="descname">isbp_walk_for_bps</code><span class="sig-paren">(</span><em>I</em>, <em>bpi</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#isbp_walk_for_bps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.isbp_walk_for_bps" title="Permalink to this definition">¶</a></dt>
<dd><p>Find branchpoints by walking from a pixel.</p>
<p>Finds branchpoints by ensuring that all pixels in the sub-skeleton can be
walked to from the set of already-found branchpoints, without visiting
the same pixel more than once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.ndarray</em>) – Binary image of a skeleton. In RivGraph, the skeleton is a reduced and
padded version of Iskel.</p></li>
<li><p><strong>bpi</strong> (<em>list</em>) – Indices within I of the branchpoint to begin walk.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bpi</strong> – Branchpoint indices in I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.naxes_connectivity">
<code class="descclassname">rivgraph.walk.</code><code class="descname">naxes_connectivity</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#naxes_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.naxes_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute number of axes of connectivity.</p>
<p>Computes the number of axes of connectivity for each pixel in an input
skeleton. The maximum is four; horizontal, vertical, and two diagonals.</p>
<p>The number of axes of pixel connectivity is used to determine where to
place branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.ndarray</em>) – Binary image of a skeleton. In RivGraph, the skeleton is a reduced and
padded version of Iskel.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Inax</strong> – Same shape as I; values correspond to the number of axes represented
by each pixel’s connectivity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.walkable_neighbors">
<code class="descclassname">rivgraph.walk.</code><code class="descname">walkable_neighbors</code><span class="sig-paren">(</span><em>link</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#walkable_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.walkable_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all walkable neighbors from the end pixel of an input link.</p>
<p>Returns all the walkable neighbors from the end pixel of an input link.
Walkable neighbors are simply pixels that are “on” within Iskel. The pixels
in the link are excluded as possibilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>link</strong> (<em>list</em>) – Contains all the pixel indices within Iskel of the link to find
walkable neighbors.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>neighs</strong> – Indices within Iskel of neighboring pixels to walk to.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="deltas.html" class="btn btn-neutral float-right" title="deltas" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, J. Schwenk &amp; J. Hariharan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>